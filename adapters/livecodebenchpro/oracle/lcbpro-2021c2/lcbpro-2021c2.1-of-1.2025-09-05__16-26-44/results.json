{
    "id": "2efbc0e1-cff2-4fb4-b68b-c7d89d8f27ab",
    "trial_name": "lcbpro-2021c2.1-of-1.2025-09-05__16-26-44",
    "task_id": "lcbpro-2021c2",
    "instruction": "LiveCodeBench Pro (Mini) - external judge.\n\nThe agent must create a C++17 solution file at /app/main.cpp.\nThis task does not include local test cases. Instead, the test harness:\n  1) POSTs the code to the external judge (/submit) to get a sid,\n  2) polls GET /result/{sid}?short=1 until status == \"done\",\n  3) passes only if the judge returns passed == true.\n\nEnvironment variables (overridable at runtime):\n  - BASE_URL: judge base URL (default http://38.80.122.117:8081)\n  - PID: problem id (default 2021C2)\n  - LANG: language (default cpp)\n  - CODE_PATH: path to code (default /app/main.cpp)\n  - JUDGE_TIMEOUT_SECS: poll timeout seconds (default 120)\n\nThis is the hard version of the problem. In the two versions, the constraints on $q$ and the time limit are different. In this version, $0 \\leq q \\leq 2 \\cdot 10^5$. You can make hacks only if all the versions of the problem are solved.\n\nA team consisting of $n$ members, numbered from $1$ to $n$, is set to present a slide show at a large meeting. The slide show contains $m$ slides.\n\nThere is an array $a$ of length $n$. Initially, the members are standing in a line in the order of $a_1, a_2, \\ldots, a_n$ from front to back. The slide show will be presented in order from slide $1$ to slide $m$. Each section will be presented by the member at the front of the line. After each slide is presented, you can move the member at the front of the line to any position in the lineup (without changing the order of the rest of the members). For example, suppose the line of members is $[\\color{red}{3},1,2,4]$. After member $3$ presents the current slide, you can change the line of members into either $[\\color{red}{3},1,2,4]$, $[1,\\color{red}{3},2,4]$, $[1,2,\\color{red}{3},4]$ or $[1,2,4,\\color{red}{3}]$.\n\nThere is also an array $b$ of length $m$. The slide show is considered good if it is possible to make member $b_i$ present slide $i$ for all $i$ from $1$ to $m$ under these constraints.\n\nHowever, your annoying boss wants to make $q$ updates to the array $b$. In the $i$-th update, he will choose a slide $s_i$ and a member $t_i$ and set $b_{s_i} := t_i$. Note that these updates are persistent, that is changes made to the array $b$ will apply when processing future updates.\n\nFor each of the $q+1$ states of array $b$, the initial state and after each of the $q$ updates, determine if the slideshow is good.\n\n### Input\n\nEach test contains multiple test cases. The first line contains the number of test cases $t$ ($1 \\le t \\le 10^4$). The description of the test cases follows.\n\nThe first line of each test case contains three integers $n$, $m$ and $q$ ($1 \\le n, m \\le 2 \\cdot 10^5$; $0 \\leq q \\leq 2 \\cdot 10^5$) -- the number of members and the number of sections.\n\nThe second line of each test case contains $n$ integers $a_1,a_2,\\ldots,a_n$ ($1 \\le a_i \\le n$) -- the initial order of the members from front to back. It is guaranteed that each integer from $1$ to $n$ appears exactly once in $a$.\n\nThe third line of each test case contains $m$ integers $b_1, b_2, \\ldots, b_m$ ($1 \\le b_i \\le n$) -- the members who should present each section.\n\nEach of the next $q$ lines contains two integers $s_i$ and $t_i$ ($1 \\le s_i \\le m$, $1 \\le t_i \\le n$) -- parameters of an update.\n\nIt is guaranteed that the sum of $n$, the sum of $m$ and the sum of $q$ over all test cases do not exceed $2 \\cdot 10^5$ respectively.\n\n### Output\n\nFor each test case, output $q+1$ lines corresponding to the $q+1$ states of the array $b$. Output \"YA\" if the slide show is good, and \"TIDAK\" otherwise.\n\nYou can output the answer in any case (upper or lower). For example, the strings \"yA\", \"Ya\", \"ya\", and \"YA\" will be recognized as positive responses.\n\n### Example\n\n#### Input #1\n\n```\n\n3\n\n4 2 2\n\n1 2 3 4\n\n1 1\n\n1 2\n\n1 1\n\n3 6 2\n\n1 2 3\n\n1 1 2 3 3 2\n\n3 3\n\n2 2\n\n4 6 2\n\n3 1 4 2\n\n3 1 1 2 3 4\n\n3 4\n\n4 2\n\n```\n\n#### Output #1\n\n```\nYA\nTIDAK\nYA\nYA\nTIDAK\nYA\nTIDAK\nYA\nYA\n```\n\n### Note\n\nFor the first test case, you do not need to move the members as both slides are presented by member $1$, who is already at the front of the line. After that, set $b_1 := 2$, now slide $1$ must be presented by member $2$ which is impossible as member $1$ will present slide $1$ first. Then, set $b_1 = 1$, the $b$ is the same as the initial $b$, making a good presentation possible.",
    "is_resolved": true,
    "failure_mode": "unset",
    "parser_results": {
        "test_external_judge": "passed"
    },
    "recording_path": "2025-09-05__16-26-44/lcbpro-2021c2/lcbpro-2021c2.1-of-1.2025-09-05__16-26-44/sessions/agent.cast",
    "total_input_tokens": 0,
    "total_output_tokens": 0,
    "trial_started_at": "2025-09-05T23:39:36.872239+00:00",
    "trial_ended_at": "2025-09-05T23:40:19.183621+00:00",
    "agent_started_at": "2025-09-05T23:39:46.481568+00:00",
    "agent_ended_at": "2025-09-05T23:39:47.380386+00:00",
    "test_started_at": "2025-09-05T23:39:50.264127+00:00",
    "test_ended_at": "2025-09-05T23:40:05.243496+00:00"
}