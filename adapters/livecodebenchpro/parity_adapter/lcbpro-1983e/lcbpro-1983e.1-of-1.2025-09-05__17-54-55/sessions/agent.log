[?2004hroot@e02e1d52f83c:/app# asciinema rec --stdin /logs/agent.cast
[?2004l[0;32masciinema: recording asciicast to /logs/agent.cast[0m
[0;32masciinema: press <ctrl-d> or type "exit" when you're done[0m
[?2004hroot@e02e1d52f83c:/app# clear
[?2004l[H[J[3J[?2004hroot@e02e1d52f83c:/app# cat > /app/main.cpp << 'EOF'
[?2004l[?2004h> #include <bits/stdc++.h>
[?2004l[?2004h> using namespace std;
[?2004l[?2004h> 
[?2004l[?2004h> const int MOD = 1e9+7;
[?2004l[?2004h> 
[?2004l[?2004h> // Modular inverse using Fermat's little theorem
[?2004l[?2004h> long long modpow(long long base, long long exp, long long mod) {
[?2004l[?2004h>     long long result = 1;
[?2004l[?2004h>     while (exp > 0) {
[?2004l[?2004h>         if (exp & 1) result = result * base % mod;
[?2004l[?2004h>         base = base * base % mod;
[?2004l[?2004h>         exp >>= 1;
[?2004l[?2004h>     }
[?2004l[?2004h>     return result;
[?2004l[?2004h> }
[?2004l[?2004h> 
[?2004l[?2004h> // Modular inverse under prime mod
[?2004l[?2004h> long long modinv(long long a, long long m = MOD) {
[?2004l[?2004h>     return modpow(a, m-2, m);
[?2004l[?2004h> }
[?2004l[?2004h> 
[?2004l[?2004h> int main() {
[?2004l[?2004h>     ios::sync_with_stdio(false);
[?2004l[?2004h>     cin.tie(nullptr);
[?2004l[?2004h> 
[?2004l[?2004h>     int t; cin >> t;
[?2004l[?2004h> 
[?2004l[?2004h>     // Sum of all n across test cases <= 5*10^5, so no problem storing
[?2004l[?2004h> 
[?2004l[?2004h>     while (t--) {
[?2004l[?2004h>         int n, k;
[?2004l[?2004h>         cin >> n >> k;
[?2004l[?2004h>         vector<int> v(n);
[?2004l[?2004h>         for (int i = 0; i < n; i++) {
[?2004l[?2004h>             cin >> v[i];
[?2004l[?2004h>         }
[?2004l[?2004h> 
[?2004l[?2004h>         // Precompute prefix sums of special and non-special balls
[?2004l[?2004h>         // Special balls: first k
[?2004l[?2004h>         // Non-special: last n-k
[?2004l[?2004h> 
[?2004l[?2004h>         // sumS = sum of special balls
[?2004l[?2004h>         // sumN = sum of non-special balls
[?2004l[?2004h>         long long sumS = 0, sumN = 0;
[?2004l[?2004h>         for (int i = 0; i < k; i++) sumS = (sumS + v[i]) % MOD;
[?2004l[?2004h>         for (int i = k; i < n; i++) sumN = (sumN + v[i]) % MOD;
[?2004l[?2004h> 
[?2004l[?2004h>         // We want expected scores of Alice and Bob modulo MOD
[?2004l[?2004h> 
[?2004l[?2004h>         // Let p = k, q = n-k
[?2004l[?2004h>         // Probability of picking special ball at any turn depends on remaining balls.
[?2004l[?2004h> 
[?2004l[?2004h>         // After analysis (from editorial approach):
[?2004l[?2004h>         // Expected score Alice = sumS * (n+k)/(2*n) + sumN * (n-k)/(2*n)
[?2004l[?2004h>         // Expected score Bob = sumS * (n-k)/(2*n) + sumN * (n+k)/(2*n)
[?2004l[?2004h> 
[?2004l[?2004h>         // Since the game is symmetric with turns switching on non-special ball picks,
[?2004l[?2004h>         // and special balls allow same player to play again,
[?2004l[?2004h>         // the expected scores are linear combinations of sums with coefficients derived from n and k.
[?2004l[?2004h> 
[?2004l[?2004h>         // Let's derive:
[?2004l[?2004h>         // Expected Alice = (sumS * (n+k) + sumN * (n-k)) * modinv(2*n) mod M
[?2004l[?2004h>         // Expected Bob   = (sumS * (n-k) + sumN * (n+k)) * modinv(2*n) mod M
[?2004l[?2004h> 
[?2004l[?2004h>         long long denom = (2LL * n) % MOD;
[?2004l[?2004h>         long long invDenom = modinv(denom);
[?2004l[?2004h> 
[?2004l[?2004h>         long long alice = ((sumS * ((n + k) % MOD)) % MOD + (sumN * ((n - k + MOD) % MOD)) % MOD) % MOD;
[?2004l[?2004h>         alice = (alice * invDenom) % MOD;
[?2004l[?2004h> 
[?2004l[?2004h>         long long bob = ((sumS * ((n - k + MOD) % MOD)) % MOD + (sumN * ((n + k) % MOD)) % MOD) % MOD;
[?2004l[?2004h>         bob = (bob * invDenom) % MOD;
[?2004l[?2004h> 
[?2004l[?2004h>         cout << alice << ; tmux wait -S done
[?2004l[?2004h> [?2004l
bash: warning: here-document at line 2 delimited by end-of-file (wanted `EOF')
[?2004hroot@e02e1d52f83c:/app# 