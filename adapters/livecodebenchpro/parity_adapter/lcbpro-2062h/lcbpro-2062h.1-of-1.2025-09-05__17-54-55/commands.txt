['asciinema rec --stdin /logs/agent.cast', 'Enter']
['clear', 'Enter']
["echo 'I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+CnVzaW5nIG5hbWVzcGFjZSBzdGQ7Cgpjb25zdCBpbnQgTU9EID0gMWU5ICsgNzsKCi8vIERpc2pvaW50IFNldCBVbmlvbiAoVW5pb24tRmluZCkgc3RydWN0dXJlCnN0cnVjdCBEU1UgewogICAgdmVjdG9yPGludD4gcDsKICAgIERTVShpbnQgbikgOiBwKG4sIC0xKSB7fQogICAgaW50IGZpbmQoaW50IGEpIHsKICAgICAgICByZXR1cm4gcFthXSA8IDAgPyBhIDogcFthXSA9IGZpbmQocFthXSk7CiAgICB9CiAgICBib29sIHVuaXRlKGludCBhLCBpbnQgYikgewogICAgICAgIGEgPSBmaW5kKGEpOyBiID0gZmluZChiKTsKICAgICAgICBpZiAoYSA9PSBiKSByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYgKHBbYV0gPiBwW2JdKSBzd2FwKGEsIGIpOwogICAgICAgIHBbYV0gKz0gcFtiXTsKICAgICAgICBwW2JdID0gYTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfTsKCi8vIENoZWNrIGlmIHR3byBzdGFycyBhcmUgZGlyZWN0bHkgY29ubmVjdGVkCi8vIFR3byBzdGFycyAoeDEseTEpIGFuZCAoeDIseTIpIGFyZSBjb25uZWN0ZWQgaWYgeDEgPT0geDIgb3IgeTEgPT0geTIgYW5kIG5vIHN0YXIgaW4gYmV0d2VlbgovLyBXZSB3aWxsIHByZWNvbXB1dGUgYWRqYWNlbmN5IGZvciBhIGdpdmVuIHN1YnNldAoKaW50IG1haW4oKSB7CiAgICBpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSk7CiAgICBjaW4udGllKG51bGxwdHIpOwoKICAgIGludCB0OwogICAgY2luID4+IHQ7CiAgICB3aGlsZSAodC0tKSB7CiAgICAgICAgaW50IG47IGNpbiA+PiBuOwogICAgICAgIHZlY3RvcjxzdHJpbmc+IGEobik7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuOyBpKyspIGNpbiA+PiBhW2ldOwoKICAgICAgICAvLyBDb2xsZWN0IHN0YXJzCiAgICAgICAgdmVjdG9yPHBhaXI8aW50LGludD4+IHN0YXJzOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgbjsgaisrKSB7CiAgICAgICAgICAgICAgICBpZiAoYVtpXVtqXSA9PSAnMScpIHN0YXJzLmVtcGxhY2VfYmFjayhpLCBqKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaW50IG0gPSAoaW50KXN0YXJzLnNpemUoKTsKICAgICAgICBpZiAobSA9PSAwKSB7CiAgICAgICAgICAgIGNvdXQgPDwgMCA8PCAiXG4iOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIC8vIFByZWNvbXB1dGUgZm9yIGVhY2ggc3RhcjoKICAgICAgICAvLyBTdGFycyBzb3J0ZWQgYnkgeCBhbmQgYnkgeQogICAgICAgIC8vIFRvIHF1aWNrbHkgY2hlY2sgZGlyZWN0IGNvbm5lY3Rpb25zCgogICAgICAgIC8vIE1hcCBzdGFycyBieSByb3cgYW5kIGJ5IGNvbHVtbgogICAgICAgIHZlY3Rvcjx2ZWN0b3I8aW50Pj4gcm93U3RhcnMobiksIGNvbFN0YXJzKG4pOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbTsgaSsrKSB7CiAgICAgICAgICAgIGludCB4ID0gc3RhcnNbaV0uZmlyc3Q7CiAgICAgICAgICAgIGludCB5ID0gc3RhcnNbaV0uc2Vjb25kOwogICAgICAgICAgICByb3dTdGFyc1t4XS5wdXNoX2JhY2soaSk7CiAgICAgICAgICAgIGNvbFN0YXJzW3ldLnB1c2hfYmFjayhpKTsKICAgICAgICB9CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgICAgICAgc29ydChyb3dTdGFyc1tpXS5iZWdpbigpLCByb3dTdGFyc1tpXS5lbmQoKSwgWyZdKGludCB1LCBpbnQgdikgewogICAgICAgICAgICAgICAgcmV0dXJuIHN0YXJzW3VdLnNlY29uZCA8IHN0YXJzW3ZdLnNlY29uZDsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHNvcnQoY29sU3RhcnNbaV0uYmVnaW4oKSwgY29sU3RhcnNbaV0uZW5kKCksIFsmXShpbnQgdSwgaW50IHYpIHsKICAgICAgICAgICAgICAgIHJldHVybiBzdGFyc1t1XS5maXJzdCA8IHN0YXJzW3ZdLmZpcnN0OwogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIC8vIEZ1bmN0aW9uIHRvIGNoZWNrIGlmIHR3byBzdGFycyBhcmUgZGlyZWN0bHkgY29ubmVjdGVkIGluIGEgc3Vic2V0IG9mIHN0YXJzCiAgICAgICAgYXV0byBkaXJlY3RseUNvbm5lY3RlZCA9IFsmXShpbnQgdSwgaW50IHYsIGludCBzdWJzZXRfbWFzaykgLT4gYm9vbCB7CiAgICAgICAgICAgIGlmICh1ID09IHYpIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgYXV0byBbeDEseTFdID0gc3RhcnNbdV07CiAgICAgICAgICAgIGF1dG8gW3gyLHkyXSA9IHN0YXJzW3ZdOwogICAgICAgICAgICBpZiAoeDEgPT0geDIpIHsKICAgICAgICAgICAgICAgIC8vIHNhbWUgcm93CiAgICAgICAgICAgICAgICBpbnQgciA9IHgxOwogICAgICAgICAgICAgICAgaW50IGMxID0gbWluKHkxLHkyKTsKICAgICAgICAgICAgICAgIGludCBjMiA9IG1heCh5MSx5Mik7CiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBhbGwgc3RhcnMgYmV0d2VlbiBjMSBhbmQgYzIgaW4gcm93U3RhcnNbcl0gYXJlIGluIHN1YnNldAogICAgICAgICAgICAgICAgYXV0byAmdmVjID0gcm93U3RhcnNbcl07CiAgICAgICAgICAgICAgICAvLyBGaW5kIHBvc2l0aW9ucyBvZiB1IGFuZCB2IGluIHZlYwogICAgICAgICAgICAgICAgaW50IHBvc191ID0gKGludCkoc3RkOjpsb3dlcl9ib3VuZCh2ZWMuYmVnaW4oKSwgdmVjLmVuZCgpLCB1LCBbJl0oaW50IGlkeCwgaW50IHZhbCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBzdGFyc1tpZHhdLnNlY29uZCA8IHN0YXJzW3ZhbF0uc2Vjb25kOwogICAgICAgICAgICAgICAgfSkgLSB2ZWMuYmVnaW4oKSk7CiAgICAgICAgICAgICAgICBpbnQgcG9zX3YgPSAoaW50KShzdGQ6Omxvd2VyX2JvdW5kKHZlYy5iZWdpbigpLCB2ZWMuZW5kKCksIHYsIFsmXShpbnQgaWR4LCBpbnQgdmFsKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0YXJzW2lkeF0uc2Vjb25kIDwgc3RhcnNbdmFsXS5zZWNvbmQ7CiAgICAgICAgICAgICAgICB9KSAtIHZlYy5iZWdpbigpKTsKICAgICAgICAgICAgICAgIGlmIChwb3NfdSA+IHBvc192KSBzd2FwKHBvc191LCBwb3Nfdik7CiAgICAgICAgICAgICAgICAvLyBDaGVjayBhbGwgc3RhcnMgYmV0d2VlbiBwb3NfdSBhbmQgcG9zX3YgYXJlIGluIHN1YnNldAogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IHBvc191KzE7IGkgPCBwb3NfdjsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCEoKHN1YnNldF9tYXNrID4+IHZlY1tpXSkgJiAxKSkgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoeTEgPT0geTIpIHsKICAgICAgICAgICAgICAgIC8vIHNhbWUgY29sdW1uCiAgICAgICAgICAgICAgICBpbnQgYyA9IHkxOwogICAgICAgICAgICAgICAgaW50IHIxID0gbWluKHgxLHgyKTsKICAgICAgICAgICAgICAgIGludCByMiA9IG1heCh4MSx4Mik7CiAgICAgICAgICAgICAgICBhdXRvICZ2ZWMgPSBjb2xTdGFyc1tjXTsKICAgICAgICAgICAgICAgIGludCBwb3NfdSA9IChpbnQpKHN0ZDo6bG93ZXJfYm91bmQodmVjLmJlZ2luKCksIHZlYy5lbmQoKSwgdSwgWyZdKGludCBpZHgsIGludCB2YWwpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RhcnNbaWR4XS5maXJzdCA8IHN0YXJzW3ZhbF0uZmlyc3Q7CiAgICAgICAgICAgICAgICB9KSAtIHZlYy5iZWdpbigpKTsKICAgICAgICAgICAgICAgIGludCBwb3NfdiA9IChpbnQpKHN0ZDo6bG93ZXJfYm91bmQodmVjLmJlZ2luKCksIHZlYy5lbmQoKSwgdiwgWyZdKGludCBpZHgsIGludCB2YWwpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RhcnNbaWR4XS5maXJzdCA8IHN0YXJzW3ZhbF0uZmlyc3Q7CiAgICAgICAgICAgICAgICB9KSAtIHZlYy5iZWdpbigpKTsKICAgICAgICAgICAgICAgIGlmIChwb3NfdSA+IHBvc192KSBzd2FwKHBvc191LCBwb3Nfdik7CiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gcG9zX3UrMTsgaSA8IHBvc192OyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAoISgoc3Vic2V0X21hc2sgPj4gdmVjW2ldKSAmIDEpKSByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfTsKCiAgICAgICAgLy8gR2l2ZW4gYSBzdWJzZXQgb2Ygc3RhcnMgKGJpdG1hc2spLCBidWlsZCBncmFwaCBvZiBkaXJlY3QgY29ubmVjdGlvbnMKICAgICAgICBhdXRvIGJ1aWxkR3JhcGggPSBbJl0oaW50IHN1YnNldF9tYXNrKSAtPiB2ZWN0b3I8dmVjdG9yPGludD4+IHsKICAgICAgICAgICAgdmVjdG9yPGludD4gbm9kZXM7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbTsgaSsrKSBpZiAoKHN1YnNldF9tYXNrID4+IGkpICYgMSkgbm9kZXMucHVzaF9iYWNrKGkpOwogICAgICAgICAgICBpbnQgc3ogPSAoaW50KW5vZGVzLnNpemUoKTsKICAgICAgICAgICAgdmVjdG9yPHZlY3RvcjxpbnQ+PiBnKHN6KTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzejsgaSsrKSB7CiAgICAgICAgICAgICAgICBmb3IgKGludCBqID0gaSsxOyBqIDwgc3o7IGorKykgewogICAgICAgICAgICAgICAgICAgIGlmIChkaXJlY3RseUNvbm5lY3RlZChub2Rlc1tpXSwgbm9kZXNbal0sIHN1YnNldF9tYXNrKSkgewogICAgICAgICAgICAgICAgICAgICAgICBnW2ldLnB1c2hfYmFjayhqKTsKICAgICAgICAgICAgICAgICAgICAgICAgZ1tqXS5wdXNoX2JhY2soaSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBnOwogICAgICAgIH07CgogICAgICAgIC8vIENvdW50IGNvbm5lY3RlZCBjb21wb25lbnRzIGluIHRoZSBncmFwaAogICAgICAgIGF1dG8gY291bnRDb21wb25lbnRzID0gWyZdKGNvbnN0IHZlY3Rvcjx2ZWN0b3I8aW50Pj4gJmcpIC0+IGludCB7CiAgICAgICAgICAgIGludCBuID0gKGludClnLnNpemUoKTsKICAgICAgICAgICAgdmVjdG9yPGJvb2w+IHZpcyhuLGZhbHNlKTsKICAgICAgICAgICAgaW50IGNvbXBzID0gMDsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgICAgICAgICAgIGlmICghdmlzW2ldKSB7CiAgICAgICAgICAgICAgICAgICAgY29tcHMrKzsKICAgICAgICAgICAgICAgICAgICBxdWV1ZTxpbnQ+IHE7IHEucHVzaChpKTsgdmlzW2ldPXRydWU7CiAgICAgICAgICAgICAgICAgICAgd2hpbGUoIXEuZW1wdHkoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpbnQgdT1xLmZyb250KCk7cS5wb3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpbnQgdzpnW3VdKSBpZiAoIXZpc1t3XSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzW3ddPXRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxLnB1c2godyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGNvbXBzOwogICAgICAgIH07CgogICAgICAgIC8vIFdlIG5lZWQgdG8gbW9kZWwgdGhlIHN0YXIgY3JlYXRpb24gb3BlcmF0aW9uOgogICAgICAgIC8vIEluIGVhY2ggb3BlcmF0aW9uLCBzZWxlY3QgYSBwb2ludCAoeCx5KSB3aXRob3V0IGEgc3Rhci4KICAgICAgICAvLyBJZiBwbGFjaW5nIGEgc3RhciBhdCAoeCx5KSBjb25uZWN0cyBhdCBsZWFzdCAzIHN0YXJzIGRpcmVjdGx5LCBjcmVhdGUgaXQuCiAgICAgICAgLy8gUmVwZWF0IHVudGlsIG5vIG5ldyBzdGFycyBjYW4gYmUgY3JlYXRlZC4KCiAgICAgICAgLy8gRm9yIGEgZ2l2ZW4gc3Vic2V0IG9mIHN0YXJzLCBjb21wdXRlIHRoZSB2YWx1ZSA9IG1pbmltYWwgbnVtYmVyIG9mIGdhbGF4aWVzIGFmdGVyIGFwcGx5aW5nIHRoZSBvcGVyYXRpb24KCiAgICAgICAgLy8gQmVjYXVzZSBuIDw9IDE0LCBtIDw9IDE5NiAobWF4IDE0KjE0KSwgYnV0IHdlIG9ubHkgaGF2ZSBzdWJzZXRzIG9mIHN0YXJzLCBhbmQgc3VtIG9mIDJebSA8PSAyXjE0CiAgICAgICAgLy8gV2UgY2FuIHByb2Nlc3MgZWFjaCBzdWJzZXQgc2VwYXJhdGVseS4KCiAgICAgICAgLy8gV2UnbGwgaW1wbGVtZW50IHRoZSBzaW11bGF0aW9uIG9mIHN0YXIgY3JlYXRpb246CiAgICAgICAgLy8gUmVwcmVzZW50IHN0YXJzIGFzIHNldCBvZiBwb2ludHMsIGtlZXAgYWRkaW5nIG5ldyBzdGFycyBpZiB0aGV5IHNhdGlzZnkgY29uZGl0aW9uLgoKICAgICAgICAvLyBUbyBvcHRpbWl6ZSwgd2Ugd2lsbCBzdG9yZSBzdGFycyBpbiBhIG1hcCBvciBzZXQKCiAgICAgICAgLy8gRm9yIGVhY2ggc3Vic2V0LCB3ZToKICAgICAgICAvLyAxKSBFeHRyYWN0IHN0YXJzCiAgICAgICAgLy8gMikgQnVpbGQgYWRqYWNlbmN5CiAgICAgICAgLy8gMykgVHJ5IHRvIGFkZCBuZXcgc3RhcnMgcmVwZWF0ZWRseSB1bnRpbCBubyBtb3JlIGNhbiBiZSBhZGRlZAogICAgICAgIC8vIDQpIENvdW50IGNvbm5lY3RlZCBjb21wb25lbnRzCgogICAgICAgIC8vIFRvIGNoZWNrIGlmIGEgbmV3IHN0YXIgYXQgKHgseSkgY2FuIGNvbm5lY3QgYXQgbGVhc3QgMyBzdGFycyBkaXJlY3RseToKICAgICAgICAvLyBXZSBjaGVjayBzdGFycyBpbiB0aGUgc2FtZSByb3cgYW5kIGNvbHVtbiB0aGF0IGFyZSBhbHJlYWR5IGluIHRoZSBzZXQuCiAgICAgICAgLy8gQ291bnQgaG93IG1hbnkgc3RhcnMgaXQgY2FuIGRpcmVjdGx5IGNvbm5lY3QgKG11c3QgYmUgPj0gMykKCiAgICAgICAgLy8gV2UgbmVlZCBmYXN0IHF1ZXJpZXMgZm9yIHN0YXJzIGluIHJvd3MgYW5kIGNvbHVtbnMKCiAgICAgICAgLy8gV2Ugd2lsbCBpbXBsZW1lbnQgdGhlIHN0YXIgY3JlYXRpb24gc2ltdWxhdGlvbiBjYXJlZnVsbHkKCiAgICAgICAgLy8gQmVjYXVzZSBuIDw9IDE0LCBjb29yZGluYXRlIHNwYWNlIGlzIHNtYWxsCgogICAgICAgIC8vIExldCdzIGltcGxlbWVudCBiZWxvdwoKICAgICAgICBpbnQgdG90YWxfc3Vic2V0cyA9IDEgPDwgbTsKICAgICAgICBsb25nIGxvbmcgcmVzdWx0ID0gMDsKCiAgICAgICAgZm9yIChpbnQgc3Vic2V0ID0gMTsgc3Vic2V0IDwgdG90YWxfc3Vic2V0czsgc3Vic2V0KyspIHsKICAgICAgICAgICAgLy8gQ3VycmVudCBzdGFycyBzZXQKICAgICAgICAgICAgc2V0PHBhaXI8aW50LGludD4+IGN1cnJlbnRTdGFyczsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBtOyBpKyspIGlmICgoc3Vic2V0ID4+IGkpICYgMSkgewogICAgICAgICAgICAgICAgY3VycmVudFN0YXJzLmluc2VydChzdGFyc1tpXSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFByZWNvbXB1dGUgcm93IGFuZCBjb2x1bW4gc3RhcnMgaW4gY3VycmVudCBzZXQKICAgICAgICAgICAgdmVjdG9yPHZlY3RvcjxpbnQ+PiBjdXJSb3dTdGFycyhuKSwgY3VyQ29sU3RhcnMobik7CiAgICAgICAgICAgIGZvciAoYXV0byAmcCA6IGN1cnJlbnRTdGFycykgewogICAgICAgICAgICAgICAgY3VyUm93U3RhcnNbcC5maXJzdF0ucHVzaF9iYWNrKHAuc2Vjb25kKTsKICAgICAgICAgICAgICAgIGN1ckNvbFN0YXJzW3Auc2Vjb25kXS5wdXNoX2JhY2socC5maXJzdCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgICAgICAgICAgIHNvcnQoY3VyUm93U3RhcnNbaV0uYmVnaW4oKSwgY3VyUm93U3RhcnNbaV0uZW5kKCkpOwogICAgICAgICAgICAgICAgc29ydChjdXJDb2xTdGFyc1tpXS5iZWdpbigpLCBjdXJDb2xTdGFyc1tpXS5lbmQoKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFdlIGJ1aWxkIGFkamFjZW5jeSBncmFwaCBmb3IgY3VycmVudCBzdGFycwogICAgICAgICAgICAvLyBNYXAgc3RhciB0byBpbmRleAogICAgICAgICAgICBtYXA8cGFpcjxpbnQsaW50PiwgaW50PiBpZHhNYXA7CiAgICAgICAgICAgIGludCBpbmRleF9jb3VudCA9IDA7CiAgICAgICAgICAgIGZvciAoYXV0byAmcCA6IGN1cnJlbnRTdGFycykgewogICAgICAgICAgICAgICAgaWR4TWFwW3BdID0gaW5kZXhfY291bnQrKzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmVjdG9yPHZlY3RvcjxpbnQ+PiBhZGooaW5kZXhfY291bnQpOwogICAgICAgICAgICAvLyBCdWlsZCBlZGdlcyBiZXR3ZWVuIHN0YXJzIGRpcmVjdGx5IGNvbm5lY3RlZAogICAgICAgICAgICB2ZWN0b3I8cGFpcjxpbnQsaW50Pj4gc3RhclZlYyhjdXJyZW50U3RhcnMuYmVnaW4oKSwgY3VycmVudFN0YXJzLmVuZCgpKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBpbmRleF9jb3VudDsgaSsrKSB7CiAgICAgICAgICAgICAgICBhdXRvIFt4MSx5MV0gPSBzdGFyVmVjW2ldOwogICAgICAgICAgICAgICAgLy8gQ2hlY2sgc2FtZSByb3cKICAgICAgICAgICAgICAgIGF1dG8gJnJvd3ZlYyA9IGN1clJvd1N0YXJzW3gxXTsKICAgICAgICAgICAgICAgIGludCBwb3MgPSAoaW50KShzdGQ6Omxvd2VyX2JvdW5kKHJvd3ZlYy5iZWdpbigpLCByb3d2ZWMuZW5kKCksIHkxKSAtIHJvd3ZlYy5iZWdpbigpKTsKICAgICAgICAgICAgICAgIGlmIChwb3MgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgaW50IHkyID0gcm93dmVjW3Bvcy0xXTsKICAgICAgICAgICAgICAgICAgICBpZiAoaWR4TWFwLmNvdW50KHt4MSx5Mn0pKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGludCBqID0gaWR4TWFwW3t4MSx5Mn1dOwogICAgICAgICAgICAgICAgICAgICAgICBhZGpbaV0ucHVzaF9iYWNrKGopOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChwb3MgKyAxIDwgKGludClyb3d2ZWMuc2l6ZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgaW50IHkyID0gcm93dmVjW3BvcysxXTsKICAgICAgICAgICAgICAgICAgICBpZiAoaWR4TWFwLmNvdW50KHt4MSx5Mn0pKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGludCBqID0gaWR4TWFwW3t4MSx5Mn1dOwogICAgICAgICAgICAgICAgICAgICAgICBhZGpbaV0ucHVzaF9iYWNrKGopOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIENoZWNrIHNhbWUgY29sdW1uCiAgICAgICAgICAgICAgICBhdXRvICZjb2x2ZWMgPSBjdXJDb2xTdGFyc1t5MV07CiAgICAgICAgICAgICAgICBpbnQgcG9zYyA9IChpbnQpKHN0ZDo6bG93ZXJfYm91bmQoY29sdmVjLmJlZ2luKCksIGNvbHZlYy5lbmQoKSwgeDEpIC0gY29sdmVjLmJlZ2luKCkpOwogICAgICAgICAgICAgICAgaWYgKHBvc2MgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgaW50IHgyID0gY29sdmVjW3Bvc2MtMV07CiAgICAgICAgICAgICAgICAgICAgaWYgKGlkeE1hcC5jb3VudCh7eDIseTF9KSkgewogICAgICAgICAgICAgICAgICAgICAgICBpbnQgaiA9IGlkeE1hcFt7eDIseTF9XTsKICAgICAgICAgICAgICAgICAgICAgICAgYWRqW2ldLnB1c2hfYmFjayhqKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAocG9zYyArIDEgPCAoaW50KWNvbHZlYy5zaXplKCkpIHsKICAgICAgICAgICAgICAgICAgICBpbnQgeDIgPSBjb2x2ZWNbcG9zYysxXTsKICAgICAgICAgICAgICAgICAgICBpZiAoaWR4TWFwLmNvdW50KHt4Mix5MX0pKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGludCBqID0gaWR4TWFwW3t4Mix5MX1dOwogICAgICAgICAgICAgICAgICAgICAgICBhZGpbaV0ucHVzaF9iYWNrKGopOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gTm93IHNpbXVsYXRlIHN0YXIgY3JlYXRpb24gb3BlcmF0aW9uCiAgICAgICAgICAgIGJvb2wgY2hhbmdlZCA9IHRydWU7CiAgICAgICAgICAgIHdoaWxlIChjaGFuZ2VkKSB7CiAgICAgICAgICAgICAgICBjaGFuZ2VkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBmb3IgKGludCB4ID0gMDsgeCA8IG47IHgrKykgewogICAgICAgICAgICAgICAgICAgIGZvciAoaW50IHkgPSAwOyB5IDwgbjsgeSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50U3RhcnMuY291bnQoe3gseX0pKSBjb250aW51ZTsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaG93IG1hbnkgc3RhcnMgdGhpcyBuZXcgc3RhciBjYW4gZGlyZWN0bHkgY29ubmVjdAogICAgICAgICAgICAgICAgICAgICAgICAvLyBDb3VudCBzdGFycyBpbiByb3cgeCB0aGF0IHdvdWxkIGJlIGRpcmVjdGx5IGNvbm5lY3RlZAogICAgICAgICAgICAgICAgICAgICAgICBhdXRvICZydmVjID0gY3VyUm93U3RhcnNbeF07CiAgICAgICAgICAgICAgICAgICAgICAgIGludCBwb3MgPSAoaW50KShzdGQ6Omxvd2VyX2JvdW5kKHJ2ZWMuYmVnaW4oKSwgcnZlYy5lbmQoKSwgeSkgLSBydmVjLmJlZ2luKCkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgaW50IGxlZnRTdGFyID0gLTEsIHJpZ2h0U3RhciA9IC0xOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAocG9zID4gMCkgbGVmdFN0YXIgPSBydmVjW3Bvcy0xXTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvcyA8IChpbnQpcnZlYy5zaXplKCkpIHJpZ2h0U3RhciA9IChwb3MgPCAoaW50KXJ2ZWMuc2l6ZSgpKSA/IHJ2ZWNbcG9zXSA6IC0xOwoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgc3RhciBhdCAoeCxsZWZ0U3RhcikgYW5kICh4LHJpZ2h0U3RhcikgYXJlIGNvbm5lY3RlZCB0aHJvdWdoIHRoaXMgbmV3bHkgYWRkZWQgc3Rhcj8KICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2UgbmVlZCB0byBlbnN1cmUgbm8gc3RhcnMgYmV0d2VlbiBuZXcgc3RhciBhbmQgdGhlc2UgbmVpZ2hib3JzLCB3aGljaCBpcyB0cnVlIGJlY2F1c2Ugd2UgdGFrZSBuZWlnaGJvcnMgY2xvc2VzdCB0byB5CgogICAgICAgICAgICAgICAgICAgICAgICBpbnQgcm93Q29ubmVjdCA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsZWZ0U3RhciAhPSAtMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgZGlyZWN0IGNvbm5lY3Rpb24gcG9zc2libGUgYnkgbmV3IHN0YXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvciBuZXcgc3RhciwgZGlyZWN0IGNvbm5lY3Rpb24gdG8gc3RhciBhdCAoeCxsZWZ0U3RhcikgaXMgZ3VhcmFudGVlZCBiZWNhdXNlIG5vIHN0YXIgYmV0d2VlbiBsZWZ0U3RhciBhbmQgeQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93Q29ubmVjdCsrOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyaWdodFN0YXIgIT0gLTEgJiYgcmlnaHRTdGFyICE9IGxlZnRTdGFyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dDb25uZWN0Kys7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvdW50IHN0YXJzIGluIGNvbHVtbiB5CiAgICAgICAgICAgICAgICAgICAgICAgIGF1dG8gJmN2ZWMgPSBjdXJDb2xTdGFyc1t5XTsKICAgICAgICAgICAgICAgICAgICAgICAgaW50IHBvc2MgPSAoaW50KShzdGQ6Omxvd2VyX2JvdW5kKGN2ZWMuYmVnaW4oKSwgY3ZlYy5lbmQoKSwgeCkgLSBjdmVjLmJlZ2luKCkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgaW50IHVwU3RhciA9IC0xLCBkb3duU3RhciA9IC0xOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAocG9zYyA+IDApIHVwU3RhciA9IGN2ZWNbcG9zYy0xXTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvc2MgPCAoaW50KWN2ZWMuc2l6ZSgpKSBkb3duU3RhciA9IChwb3NjIDwgKGludCljdmVjLnNpemUoKSkgPyBjdmVjW3Bvc2NdIDogLTE7CgogICAgICAgICAgICAgICAgICAgICAgICBpbnQgY29sQ29ubmVjdCA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1cFN0YXIgIT0gLTEpIGNvbENvbm5lY3QrKzsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvd25TdGFyICE9IC0xICYmIGRvd25TdGFyICE9IHVwU3RhcikgY29sQ29ubmVjdCsrOwoKICAgICAgICAgICAgICAgICAgICAgICAgaW50IHRvdGFsQ29ubmVjdCA9IHJvd0Nvbm5lY3QgKyBjb2xDb25uZWN0OwogICAgICAgICAgICAgICAgICAgICAgICBpZiAodG90YWxDb25uZWN0ID49IDMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZCBuZXcgc3RhcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0YXJzLmluc2VydCh7eCx5fSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJSb3dTdGFyc1t4XS5pbnNlcnQoc3RkOjpsb3dlcl9ib3VuZChjdXJSb3dTdGFyc1t4XS5iZWdpbigpLCBjdXJSb3dTdGFyc1t4XS5lbmQoKSwgeSksIHkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VyQ29sU3RhcnNbeV0uaW5zZXJ0KHN0ZDo6bG93ZXJfYm91bmQoY3VyQ29sU3RhcnNbeV0uYmVnaW4oKSwgY3VyQ29sU3RhcnNbeV0uZW5kKCksIHgpLCB4KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ290byBjcmVhdGVkX3N0YXI7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjcmVhdGVkX3N0YXI6IDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gQWZ0ZXIgbm8gbW9yZSBzdGFycyBjYW4gYmUgY3JlYXRlZCwgY291bnQgY29ubmVjdGVkIGNvbXBvbmVudHMgd2l0aCBkaXJlY3QgY29ubmVjdGlvbnMKCiAgICAgICAgICAgIC8vIFJlYnVpbGQgaWR4TWFwIGFuZCBncmFwaAogICAgICAgICAgICBpZHhNYXAuY2xlYXIoKTsKICAgICAgICAgICAgaW5kZXhfY291bnQgPSAwOwogICAgICAgICAgICBmb3IgKGF1dG8gJnAgOiBjdXJyZW50U3RhcnMpIHsKICAgICAgICAgICAgICAgIGlkeE1hcFtwXSA9IGluZGV4X2NvdW50Kys7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYWRqLmFzc2lnbihpbmRleF9jb3VudCwgdmVjdG9yPGludD4oKSk7CiAgICAgICAgICAgIHZlY3RvcjxwYWlyPGludCxpbnQ+PiBzdGFyVmVjMihjdXJyZW50U3RhcnMuYmVnaW4oKSwgY3VycmVudFN0YXJzLmVuZCgpKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBpbmRleF9jb3VudDsgaSsrKSB7CiAgICAgICAgICAgICAgICBhdXRvIFt4MSx5MV0gPSBzdGFyVmVjMltpXTsKICAgICAgICAgICAgICAgIC8vIHNhbWUgcm93CiAgICAgICAgICAgICAgICBhdXRvICZyb3d2ZWMgPSBjdXJSb3dTdGFyc1t4MV07CiAgICAgICAgICAgICAgICBpbnQgcG9zID0gKGludCkoc3RkOjpsb3dlcl9ib3VuZChyb3d2ZWMuYmVnaW4oKSwgcm93dmVjLmVuZCgpLCB5MSkgLSByb3d2ZWMuYmVnaW4oKSk7CiAgICAgICAgICAgICAgICBpZiAocG9zID4gMCkgewogICAgICAgICAgICAgICAgICAgIGludCB5MiA9IHJvd3ZlY1twb3MtMV07CiAgICAgICAgICAgICAgICAgICAgaWYgKGlkeE1hcC5jb3VudCh7eDEseTJ9KSkgewogICAgICAgICAgICAgICAgICAgICAgICBpbnQgaiA9IGlkeE1hcFt7eDEseTJ9XTsKICAgICAgICAgICAgICAgICAgICAgICAgYWRqW2ldLnB1c2hfYmFjayhqKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAocG9zICsgMSA8IChpbnQpcm93dmVjLnNpemUoKSkgewogICAgICAgICAgICAgICAgICAgIGludCB5MiA9IHJvd3ZlY1twb3MrMV07CiAgICAgICAgICAgICAgICAgICAgaWYgKGlkeE1hcC5jb3VudCh7eDEseTJ9KSkgewogICAgICAgICAgICAgICAgICAgICAgICBpbnQgaiA9IGlkeE1hcFt7eDEseTJ9XTsKICAgICAgICAgICAgICAgICAgICAgICAgYWRqW2ldLnB1c2hfYmFjayhqKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvLyBzYW1lIGNvbHVtbgogICAgICAgICAgICAgICAgYXV0byAmY29sdmVjID0gY3VyQ29sU3RhcnNbeTFdOwogICAgICAgICAgICAgICAgaW50IHBvc2MgPSAoaW50KShzdGQ6Omxvd2VyX2JvdW5kKGNvbHZlYy5iZWdpbigpLCBjb2x2ZWMuZW5kKCksIHgxKSAtIGNvbHZlYy5iZWdpbigpKTsKICAgICAgICAgICAgICAgIGlmIChwb3NjID4gMCkgewogICAgICAgICAgICAgICAgICAgIGludCB4MiA9IGNvbHZlY1twb3NjLTFdOwogICAgICAgICAgICAgICAgICAgIGlmIChpZHhNYXAuY291bnQoe3gyLHkxfSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW50IGogPSBpZHhNYXBbe3gyLHkxfV07CiAgICAgICAgICAgICAgICAgICAgICAgIGFkaltpXS5wdXNoX2JhY2soaik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKHBvc2MgKyAxIDwgKGludCljb2x2ZWMuc2l6ZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgaW50IHgyID0gY29sdmVjW3Bvc2MrMV07CiAgICAgICAgICAgICAgICAgICAgaWYgKGlkeE1hcC5jb3VudCh7eDIseTF9KSkgewogICAgICAgICAgICAgICAgICAgICAgICBpbnQgaiA9IGlkeE1hcFt7eDIseTF9XTsKICAgICAgICAgICAgICAgICAgICAgICAgYWRqW2ldLnB1c2hfYmFjayhqKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIENvdW50IGNvbm5lY3RlZCBjb21wb25lbnRzCiAgICAgICAgICAgIGludCBjb21wcyA9IDA7CiAgICAgICAgICAgIHZlY3Rvcjxib29sPiB2aXMoaW5kZXhfY291bnQsZmFsc2UpOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGluZGV4X2NvdW50OyBpKyspIHsKICAgICAgICAgICAgICAgIGlmICghdmlzW2ldKSB7CiAgICAgICAgICAgICAgICAgICAgY29tcHMrKzsKICAgICAgICAgICAgICAgICAgICBxdWV1ZTxpbnQ+IHE7IHEucHVzaChpKTsgdmlzW2ldID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB3aGlsZSghcS5lbXB0eSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGludCB1ID0gcS5mcm9udCgpOyBxLnBvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGludCB3IDogYWRqW3VdKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXZpc1t3XSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc1t3XSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcS5wdXNoKHcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXN1bHQgPSAocmVzdWx0ICsgY29tcHMpICUgTU9EOwogICAgICAgIH0KCiAgICAgICAgY291dCA8PCByZXN1bHQgPDwgIlxuIjsKICAgIH0KCiAgICByZXR1cm4gMDsKfQo=' | base64 -d > /app/main.cpp", 'Enter']
['asciinema rec --stdin /logs/tests.cast', 'Enter']
['clear', 'Enter']
['bash ', '/tests/run-tests.sh', 'Enter']
['C-d']
['C-d']
