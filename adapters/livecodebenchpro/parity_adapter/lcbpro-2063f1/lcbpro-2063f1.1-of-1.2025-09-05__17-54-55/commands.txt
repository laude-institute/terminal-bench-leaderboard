['asciinema rec --stdin /logs/agent.cast', 'Enter']
['clear', 'Enter']
["echo 'I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+CnVzaW5nIG5hbWVzcGFjZSBzdGQ7Cgpjb25zdCBpbnQgTU9EID0gOTk4MjQ0MzUzOwoKLy8gUHJlY29tcHV0ZSBjYXRhbGFuIG51bWJlcnMgdXAgdG8gbWF4TgppbnQgbWF4TiA9IDUwMDA7CmludCBjYXRhbGFuWzUwMDFdOwoKLy8gTW9kdWxhciBhcml0aG1ldGljIGhlbHBlcnMKaW50IGFkZChpbnQgYSwgaW50IGIpIHsKICAgIGEgKz0gYjsKICAgIGlmIChhID49IE1PRCkgYSAtPSBNT0Q7CiAgICByZXR1cm4gYTsKfQoKaW50IG11bChpbnQgYSwgaW50IGIpIHsKICAgIHJldHVybiAoaW50KSgoMUxMICogYSAqIGIpICUgTU9EKTsKfQoKdm9pZCBwcmVjb21wdXRlX2NhdGFsYW4oKSB7CiAgICB2ZWN0b3I8aW50PiBmYWN0KDIqbWF4TisxLCAxKTsKICAgIHZlY3RvcjxpbnQ+IGludl9mYWN0KDIqbWF4TisxLCAxKTsKICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IDIqbWF4TjsgaSsrKSBmYWN0W2ldID0gbXVsKGZhY3RbaS0xXSwgaSk7CiAgICBpbnZfZmFjdFsyKm1heE5dID0gMTsKICAgIC8vIEZlcm1hdCdzIGxpdHRsZSB0aGVvcmVtIGZvciBpbnZlcnNlIGZhY3RvcmlhbAogICAgaW52X2ZhY3RbMiptYXhOXSA9IHBvd19tb2QoZmFjdFsyKm1heE5dLCBNT0QtMik7CiAgICBmb3IgKGludCBpID0gMiptYXhOLTE7IGkgPj0gMDsgaS0tKSBpbnZfZmFjdFtpXSA9IG11bChpbnZfZmFjdFtpKzFdLCBpKzEpOwoKICAgIGF1dG8gY29tYiA9IFsmXShpbnQgbiwgaW50IHIpIHsKICAgICAgICBpZiAociA+IG4gfHwgciA8IDApIHJldHVybiAwOwogICAgICAgIHJldHVybiBtdWwoZmFjdFtuXSwgbXVsKGludl9mYWN0W3JdLCBpbnZfZmFjdFtuLXJdKSk7CiAgICB9OwoKICAgIGZvciAoaW50IGkgPSAwOyBpIDw9IG1heE47IGkrKykgewogICAgICAgIC8vIGNhdGFsYW5baV0gPSBjb21iKDIqaSwgaSkvKGkrMSkgbW9kCiAgICAgICAgaW50IGMgPSBjb21iKDIqaSwgaSk7CiAgICAgICAgaW50IGludiA9IHBvd19tb2QoaSsxLCBNT0QtMik7CiAgICAgICAgY2F0YWxhbltpXSA9IG11bChjLCBpbnYpOwogICAgfQp9CgppbnQgcG93X21vZChpbnQgYmFzZSwgaW50IGV4cCkgewogICAgaW50IHJlcyA9IDE7CiAgICBpbnQgY3VyID0gYmFzZTsKICAgIHdoaWxlIChleHAgPiAwKSB7CiAgICAgICAgaWYgKGV4cCAmIDEpIHJlcyA9IG11bChyZXMsIGN1cik7CiAgICAgICAgY3VyID0gbXVsKGN1ciwgY3VyKTsKICAgICAgICBleHAgPj49IDE7CiAgICB9CiAgICByZXR1cm4gcmVzOwp9CgppbnQgbjsKdmVjdG9yPHBhaXI8aW50LGludD4+IGNsdWVzOwoKLy8gRFAgbWVtbyBmb3IgY291bnRpbmcgYmFsYW5jZWQgc2VxdWVuY2VzIHdpdGggZ2l2ZW4gZml4ZWQgZ29vZCBwYWlycwovLyBXZSdsbCB1c2UgbWVtb2l6YXRpb24gb24gaW50ZXJ2YWxzIFtsLHJdCi8vIFdlIG5lZWQgdG8ga25vdyB3aGljaCBwYWlycyBhcmUgZml4ZWQgaW4gdGhlIGludGVydmFsCgovLyBUbyBmYXN0IGNoZWNrIGlmIChsLHIpIGlzIGEgZml4ZWQgZ29vZCBwYWlyLCB1c2UgYSBib29sZWFuIGFycmF5CnZlY3Rvcjx2ZWN0b3I8Ym9vbD4+IGZpeGVkOwoKLy8gV2UnbGwgYWxzbyB1c2UgcHJlZml4IHN1bXMgb3IgbWFwcyB0byBhdm9pZCByZXBlYXRlZCByZWNvbXB1dGF0aW9uCgovLyBEUCBmdW5jdGlvbjogY291bnQgbnVtYmVyIG9mIGJhbGFuY2VkIHNlcXVlbmNlcyBpbiBpbnRlcnZhbCBbbCwgcl0KLy8gc2F0aXNmeWluZyB0aGF0IGFsbCBmaXhlZCBwYWlycyBpbnNpZGUgW2wscl0gYXJlIGluY2x1ZGVkCi8vIFVzaW5nIHRvcC1kb3duIERQCgp2ZWN0b3I8dmVjdG9yPGludD4+IGRwOwoKaW50IGNhbGMoaW50IGwsIGludCByKSB7CiAgICBpZiAobCA+IHIpIHJldHVybiAxOyAvLyBlbXB0eSBzZXF1ZW5jZQogICAgaWYgKChyIC0gbCArIDEpICUgMiAhPSAwKSByZXR1cm4gMDsgLy8gb2RkIGxlbmd0aCBjYW4ndCBiZSBiYWxhbmNlZAogICAgaW50ICZyZXMgPSBkcFtsXVtyXTsKICAgIGlmIChyZXMgIT0gLTEpIHJldHVybiByZXM7CiAgICByZXMgPSAwOwoKICAgIC8vIFdlIG11c3QgZmluZCBhIGdvb2QgcGFpciAobCwgaykgdG8gc3BsaXQgdGhlIHNlcXVlbmNlCiAgICAvLyAobCxrKSBtdXN0IGJlIGEgZml4ZWQgZ29vZCBwYWlyIG9yIGNhbiBiZSBhbnkgdmFsaWQgZ29vZCBwYWlyIGlmIG5vIGZpeGVkIHBhaXIgc3RhcnRzIGF0IGwKICAgIC8vIEJ1dCBpZiBhbnkgZml4ZWQgZ29vZCBwYWlyIHN0YXJ0cyBhdCBsLCB3ZSBtdXN0IHVzZSB0aGF0IGZpeGVkIHBhaXIKCiAgICAvLyBGaW5kIGFsbCBmaXhlZCBwYWlycyBzdGFydGluZyBhdCBsCiAgICB2ZWN0b3I8aW50PiBmaXhlZF9lbmRzOwogICAgZm9yIChpbnQgayA9IGwrMTsgayA8PSByOyBrKz0yKSB7CiAgICAgICAgaWYgKGZpeGVkW2xdW2tdKSBmaXhlZF9lbmRzLnB1c2hfYmFjayhrKTsKICAgIH0KCiAgICBpZiAoIWZpeGVkX2VuZHMuZW1wdHkoKSkgewogICAgICAgIC8vIE11c3QgdXNlIGZpeGVkIHBhaXJzIG9ubHkKICAgICAgICBmb3IgKGludCBrIDogZml4ZWRfZW5kcykgewogICAgICAgICAgICBpZiAoayA+IHIpIGNvbnRpbnVlOwogICAgICAgICAgICBpbnQgbGVmdCA9IGNhbGMobCsxLCBrLTEpOwogICAgICAgICAgICBpbnQgcmlnaHQgPSBjYWxjKGsrMSwgcik7CiAgICAgICAgICAgIHJlcyA9IGFkZChyZXMsIG11bChsZWZ0LCByaWdodCkpOwogICAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICAgLy8gTm8gZml4ZWQgcGFpcnMgc3RhcnQgYXQgbCwgY2FuIGNob29zZSBhbnkgdmFsaWQgcGFpcgogICAgICAgIC8vIFRyeSBhbGwgayBmcm9tIGwrMSB0byByIHN0ZXAgMgogICAgICAgIGZvciAoaW50IGsgPSBsKzE7IGsgPD0gcjsgays9MikgewogICAgICAgICAgICAvLyBJZiAobCxrKSBpcyBmaXhlZCBmb3JiaWRkZW4gKHNob3VsZG4ndCBoYXBwZW4gYmVjYXVzZSBubyBmaXhlZCBwYWlycyBzdGFydCBhdCBsKSwgc2tpcAogICAgICAgICAgICAvLyBOZWVkIHRvIGVuc3VyZSB0aGF0IG5vIGZpeGVkIHBhaXJzIGNvbnRyYWRpY3QgKGwsaykKICAgICAgICAgICAgLy8gQnV0IG5vIGZpeGVkIHBhaXJzIHN0YXJ0IGF0IGwsIHNvIG5vIHByb2JsZW0KICAgICAgICAgICAgaW50IGxlZnQgPSBjYWxjKGwrMSwgay0xKTsKICAgICAgICAgICAgaW50IHJpZ2h0ID0gY2FsYyhrKzEsIHIpOwogICAgICAgICAgICByZXMgPSBhZGQocmVzLCBtdWwobGVmdCwgcmlnaHQpKTsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gcmVzOwp9CgppbnQgbWFpbigpIHsKICAgIGlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsKICAgIGNpbi50aWUobnVsbHB0cik7CgogICAgcHJlY29tcHV0ZV9jYXRhbGFuKCk7CgogICAgaW50IHQ7IGNpbiA+PiB0OwogICAgd2hpbGUgKHQtLSkgewogICAgICAgIGNpbiA+PiBuOwogICAgICAgIGNsdWVzLmNsZWFyKCk7CiAgICAgICAgY2x1ZXMucmVzaXplKG4pOwogICAgICAgIC8vIGZpeGVkIGFycmF5IHNpemUgMm4rMSBmb3IgMS1iYXNlZCBpbmRleGluZwogICAgICAgIGZpeGVkLmFzc2lnbigyKm4rMSwgdmVjdG9yPGJvb2w+KDIqbisxLCBmYWxzZSkpOwoKICAgICAgICAvLyBPdXRwdXQgYmVmb3JlIGNsdWVzOiB0b3RhbCBjYXRhbGFuW25dCiAgICAgICAgdmVjdG9yPGludD4gYW5zd2VyczsKICAgICAgICBhbnN3ZXJzLnB1c2hfYmFjayhjYXRhbGFuW25dKTsKCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgICAgICAgaW50IGwscjsgY2luID4+IGwgPj4gcjsKICAgICAgICAgICAgY2x1ZXNbaV0gPSB7bCxyfTsKICAgICAgICB9CgogICAgICAgIC8vIEZvciBlYWNoIGNsdWUsIG1hcmsgZml4ZWQgcGFpciBhbmQgY29tcHV0ZSBhbnN3ZXIKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG47IGkrKykgewogICAgICAgICAgICBhdXRvIFtsLHJdID0gY2x1ZXNbaV07CiAgICAgICAgICAgIGZpeGVkW2xdW3JdID0gdHJ1ZTsKCiAgICAgICAgICAgIGRwLmFzc2lnbigyKm4rMSwgdmVjdG9yPGludD4oMipuKzEsIC0xKSk7CiAgICAgICAgICAgIGludCByZXMgPSBjYWxjKDEsIDIqbik7CiAgICAgICAgICAgIGFuc3dlcnMucHVzaF9iYWNrKHJlcyk7CiAgICAgICAgfQoKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IChpbnQpYW5zd2Vycy5zaXplKCk7IGkrKykgewogICAgICAgICAgICBjb3V0IDw8IGFuc3dlcnNbaV07CiAgICAgICAgICAgIGlmIChpICE9IChpbnQpYW5zd2Vycy5zaXplKCkgLSAxKSBjb3V0IDw8ICcgJzsKICAgICAgICB9CiAgICAgICAgY291dCA8PCAnXG4nOwogICAgfQoKICAgIHJldHVybiAwOwp9Cg==' | base64 -d > /app/main.cpp", 'Enter']
['asciinema rec --stdin /logs/tests.cast', 'Enter']
['clear', 'Enter']
['bash ', '/tests/run-tests.sh', 'Enter']
['C-d']
['C-d']
