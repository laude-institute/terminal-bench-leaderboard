{
    "id": "82e20408-98b4-4c0b-acd8-826f9899fe07",
    "trial_name": "lcbpro-2101d.1-of-1.2025-09-05__17-54-55",
    "task_id": "lcbpro-2101d",
    "instruction": "LiveCodeBench Pro (Mini) - external judge.\n\nThe agent must create a C++17 solution file at /app/main.cpp.\nThis task does not include local test cases. Instead, the test harness:\n  1) POSTs the code to the external judge (/submit) to get a sid,\n  2) polls GET /result/{sid}?short=1 until status == \"done\",\n  3) passes only if the judge returns passed == true.\n\nEnvironment variables (overridable at runtime):\n  - BASE_URL: judge base URL (default http://38.80.122.117:8081)\n  - PID: problem id (default 2101D)\n  - LANG: language (default cpp)\n  - CODE_PATH: path to code (default /app/main.cpp)\n  - JUDGE_TIMEOUT_SECS: poll timeout seconds (default 120)\n\nAn array $b$ of length $|b|$ is cute if the sum of the length of its Longest Increasing Subsequence (LIS) and the length of its Longest Decreasing Subsequence (LDS)$^{\\text{∗}}$ is exactly one more than the length of the array. More formally, the array $b$ is cute if $\\operatorname{LIS}(b) + \\operatorname{LDS}(b) = |b| + 1$.\n\nYou are given a permutation $a$ of length $n$$^{\\\\text{†}}$. Your task is to count the number of non-empty subarrays$^{\\\\text{‡}}$ of permutation $a$ that are cute.\n\n$^{\\text{∗}}$A sequence $x$ is a subsequence of a sequence $y$ if $x$ can be obtained from $y$ by the deletion of several (possibly, zero or all) element from arbitrary positions.\n\nThe longest increasing (decreasing) subsequence of an array is the longest subsequence such that its elements are ordered in strictly increasing (decreasing) order.\n\n$^{\\text{†}}$A permutation of length $n$ is an array consisting of $n$ distinct integers from $1$ to $n$ in arbitrary order. For example, $[2,3,1,5,4]$ is a permutation, but $[1,2,2]$ is not a permutation ($2$ appears twice in the array), and $[1,3,4]$ is also not a permutation ($n=3$ but there is $4$ in the array).\n\n$^{\\text{‡}}$An array $x$ is a subarray of an array $y$ if $x$ can be obtained from $y$ by the deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end.\n\n### Input\n\nEach test contains multiple test cases. The first line contains the number of test cases $t$ ($1 \\le t \\le 10^4$). The description of the test cases follows.\n\nThe first line of each test case contains a single integer $n$ ($1\\le n\\le 2 \\cdot 10^5 $) -- the length of permutation $a$.\n\nThe second line of each test case contains $n$ integers $a_1, a_2, \\ldots, a_n$ ($1 \\le a_i \\le n$) -- the elements of permutation $a$.\n\nIt is guaranteed that the sum of $n$ over all test cases does not exceed $2 \\cdot 10^5$.\n\n### Output\n\nFor each test case, output the number of cute non-empty subarrays of permutation $a$.\n\n### Example\n\n#### Input #1\n\n```\n\n5\n\n3\n\n3 1 2\n\n5\n\n2 3 4 5 1\n\n4\n\n3 4 1 2\n\n7\n\n1 2 3 4 5 6 7\n\n10\n\n7 8 2 4 5 10 1 3 6 9\n\n```\n\n#### Output #1\n\n```\n6\n15\n9\n28\n36\n```\n\n### Note\n\nIn the first test case, all of the $6$ non-empty subarrays are cute:\n\n- $[3]$: $\\operatorname{LIS}([3]) + \\operatorname{LDS}([3]) = 1 + 1 = 2$.\n- $[1]$: $\\operatorname{LIS}([1]) + \\operatorname{LDS}([1]) = 1 + 1 = 2$.\n- $[2]$: $\\operatorname{LIS}([2]) + \\operatorname{LDS}([2]) = 1 + 1 = 2$.\n- $[3, 1]$: $\\operatorname{LIS}([3, 1]) + \\operatorname{LDS}([3, 1]) = 1 + 2 = 3$.\n- $[1, 2]$: $\\operatorname{LIS}([1, 2]) + \\operatorname{LDS}([1, 2]) = 2 + 1 = 3$.\n- $[3, 1, 2]$: $\\operatorname{LIS}([3, 1, 2]) + \\operatorname{LDS}([3, 1, 2]) = 2 + 2 = 4$.\n\nIn the second test case, one of the cute subarrays is $[2, 3, 4, 5, 1]$ as $\\operatorname{LIS}([2, 3, 4, 5, 1]) = 4$ and $\\operatorname{LDS}([2, 3, 4, 5, 1]) = 2$, which satisfies $4 + 2 = 5 + 1$.",
    "is_resolved": false,
    "failure_mode": "unset",
    "parser_results": {
        "test_external_judge": "failed"
    },
    "recording_path": "2025-09-05__17-54-55/lcbpro-2101d/lcbpro-2101d.1-of-1.2025-09-05__17-54-55/sessions/agent.cast",
    "total_input_tokens": 1491,
    "total_output_tokens": 1045,
    "trial_started_at": "2025-09-06T01:43:49.100671+00:00",
    "trial_ended_at": "2025-09-06T01:44:39.044702+00:00",
    "agent_started_at": "2025-09-06T01:44:01.098426+00:00",
    "agent_ended_at": "2025-09-06T01:44:15.039776+00:00",
    "test_started_at": "2025-09-06T01:44:17.977486+00:00",
    "test_ended_at": "2025-09-06T01:44:22.545365+00:00"
}