['asciinema rec --stdin /logs/agent.cast', 'Enter']
['clear', 'Enter']
["echo 'I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+CnVzaW5nIG5hbWVzcGFjZSBzdGQ7CgovLyBQcm9ibGVtOiBMaXZlQ29kZUJlbmNoIFBybyAoTWluaSkgLSBoYXJkIHZlcnNpb24KLy8gTW92ZXMgc3RvbmVzIG9uIGdyYXBoIHZlcnRpY2VzIHdpdGggc2ltdWx0YW5lb3VzIG1vdmVzCi8vIE91dHB1dCBhIHZhbGlkIHNlcXVlbmNlIG9mIG9wZXJhdGlvbnMgaWYgb25lIGV4aXN0cwoKY29uc3QgaW50IE1BWE4gPSAyMDA1OwoKaW50IG4sIG0sIHRjYXNlOwpzdHJpbmcgc19pbml0LCBzX3RhcmdldDsKdmVjdG9yPGludD4gYWRqW01BWE5dOwoKLy8gU3RvcmUgaW5pdGlhbCBhbmQgdGFyZ2V0IHN0b25lIHBvc2l0aW9ucwp2ZWN0b3I8aW50PiBzdG9uZXNfaW5pdCwgc3RvbmVzX3RhcmdldDsKCi8vIEZvciBlYWNoIHN0b25lLCBzdG9yZSBpdHMgY3VycmVudCBwb3NpdGlvbgovLyBXZSBrZWVwIHN0b25lcyBpbmRleGVkIDAuLmMtMQoKLy8gTWFwIGZyb20gdmVydGV4IHRvIHN0b25lIGluZGV4IChvciAtMSBpZiBubyBzdG9uZSkKaW50IHZlcnRleF9zdG9uZVtNQVhOXTsKCi8vIFdlIHdpbGwgdHJ5IHRvIGZpbmQgYSBzZXF1ZW5jZSBvZiBtb3ZlcyAoZWFjaCBtb3ZlIGlzIGEgdmVjdG9yPGludD4gb2YgcG9zaXRpb25zIGZvciBzdG9uZXMpCi8vIHVwIHRvIDIqbiBtb3ZlcwoKLy8gVGhlIGFwcHJvYWNoOgovLyBTaW5jZSB0aGUgbnVtYmVyIG9mIHN0b25lcyBpcyB0aGUgc2FtZSBpbiBzIGFuZCB0LCBhbmQgZWFjaCB2ZXJ0ZXggY2FuIGhvbGQgYXQgbW9zdCBvbmUgc3RvbmUsCi8vIHRoZSBwcm9ibGVtIHJlZHVjZXMgdG8gZmluZGluZyBhIHNlcXVlbmNlIG9mIHN0YXRlcyBvZiB0aGUgc3RvbmVzIHdoZXJlIGVhY2ggc3RvbmUgbW92ZXMgYWxvbmcgZWRnZXMKLy8gYW5kIHN0b25lcyBkbyBub3QgY29sbGlkZS4KCi8vIFRoZSBwcm9ibGVtIGlzIGtub3duIHRvIGJlIHNvbHZhYmxlIHdpdGggYXQgbW9zdCAybiBtb3ZlcyBpZiBhIHNvbHV0aW9uIGV4aXN0cy4KLy8gV2Ugd2lsbCB1c2UgYSBCRlMtYmFzZWQgYXBwcm9hY2ggdG8gdHJ5IHRvIGZpbmQgYSBwYXRoIGZyb20gaW5pdGlhbCBjb25maWd1cmF0aW9uIHRvIHRhcmdldCBjb25maWd1cmF0aW9uLgovLyBCdXQgQkZTIG92ZXIgc3RhdGVzIGlzIHRvbyBsYXJnZSAoMl5uKSwgc28gd2UgdXNlIGEgaGV1cmlzdGljIGJhc2VkIG9uIHRoZSBlZGl0b3JpYWwgYXBwcm9hY2g6CgovLyBLZXkgaW5zaWdodCBmcm9tIGVkaXRvcmlhbCAobm90IGdpdmVuLCBidXQgd2UgY2FuIGFwcGx5IGEga25vd24gYXBwcm9hY2gpOgovLyBGaXJzdCwgd2UgY2hlY2sgY29ubmVjdGl2aXR5IHRvIGVuc3VyZSB0aGF0IHRoZSBzZXQgb2Ygc3RvbmVzIGNhbiBiZSBwZXJtdXRlZCB0byB0YXJnZXQgcG9zaXRpb25zLgovLyBUaGVuLCB3ZSBmaW5kIGEgbWF0Y2hpbmcgYmV0d2VlbiBpbml0aWFsIHN0b25lcyBhbmQgdGFyZ2V0IHN0b25lcy4KLy8gVGhlbiwgd2UgbW92ZSBzdG9uZXMgYWxvbmcgc2hvcnRlc3QgcGF0aHMgc2ltdWx0YW5lb3VzbHkgaW4gc3RhZ2VzLgoKLy8gV2UgaW1wbGVtZW50IHRoZSBmb2xsb3dpbmcgcGxhbjoKLy8gMS4gSWRlbnRpZnkgc3RvbmVzIGluaXRpYWwgYW5kIHRhcmdldCBwb3NpdGlvbnMuCi8vIDIuIENvbXB1dGUgc2hvcnRlc3QgZGlzdGFuY2VzIGFuZCBwYXRocyBmcm9tIGVhY2ggc3RvbmUgaW5pdGlhbCBwb3NpdGlvbiB0byBpdHMgdGFyZ2V0IHBvc2l0aW9uLgovLyAzLiBXZSBtb3ZlIHN0b25lcyBzdGVwIGJ5IHN0ZXAgYWxvbmcgdGhlc2UgcGF0aHMgc2ltdWx0YW5lb3VzbHkuCi8vIDQuIFdlIGVuc3VyZSBubyBjb2xsaXNpb25zIGJ5IG9yZGVyaW5nIG1vdmVzIGNhcmVmdWxseS4KCi8vIFRvIGF2b2lkIGNvbGxpc2lvbnMsIHVzZSBhIGxheWVyZWQgYXBwcm9hY2g6Ci8vIE1vdmUgc3RvbmVzIG9uZSBzdGVwIGNsb3NlciB0byB0aGVpciB0YXJnZXRzIGluIGVhY2ggb3BlcmF0aW9uLAovLyBzdGFydGluZyBmcm9tIHN0b25lcyBmYXJ0aGVzdCBmcm9tIHRoZWlyIHRhcmdldC4KCi8vIEltcGxlbWVudGF0aW9uIGRldGFpbHM6Ci8vIC0gV2UgYnVpbGQgcGF0aHMgZm9yIGVhY2ggc3RvbmUgZnJvbSBpbml0aWFsIHRvIHRhcmdldC4KLy8gLSBUaGUgbG9uZ2VzdCBwYXRoIGxlbmd0aCBmb3IgYW55IHN0b25lIGlzIGF0IG1vc3Qgbi4KLy8gLSBXZSBzaW11bGF0ZSBtb3ZlcywgZm9yIGVhY2ggc3RlcCwgc3RvbmVzIHRoYXQgY2FuIG1vdmUgZm9yd2FyZCBhbG9uZyB0aGVpciBwYXRoIGRvIHNvIHNpbXVsdGFuZW91c2x5LgovLyAtIFRoaXMgdGFrZXMgYXQgbW9zdCAyKm4gbW92ZXMuCgovLyBJZiBubyBzb2x1dGlvbiwgcHJpbnQgTm8uCgovLyBXZSB1c2UgemVyby1iYXNlZCBpbmRleGluZyBpbnRlcm5hbGx5LCBidXQgaW5wdXQgaXMgMS1iYXNlZC4KCi8vIERhdGEgc3RydWN0dXJlcyBmb3IgcGF0aHM6CnZlY3Rvcjx2ZWN0b3I8aW50Pj4gc3RvbmVfcGF0aHM7CgovLyBGb3IgZWFjaCBzdG9uZSwgY3VycmVudCBwb3NpdGlvbiBpbmRleCBpbiBwYXRoCnZlY3RvcjxpbnQ+IHBhdGhfcG9zOwoKLy8gTnVtYmVyIG9mIHN0b25lcwppbnQgY19zdG9uZXM7CgovLyBCRlMgZm9yIHNob3J0ZXN0IHBhdGgKdmVjdG9yPGludD4gc2hvcnRlc3RfcGF0aChpbnQgc3RhcnQsIGludCBlbmQpIHsKICAgIHZlY3RvcjxpbnQ+IGRpc3QobiwgLTEpOwogICAgdmVjdG9yPGludD4gcGFyZW50KG4sIC0xKTsKICAgIHF1ZXVlPGludD4gcTsKICAgIGRpc3Rbc3RhcnRdID0gMDsKICAgIHEucHVzaChzdGFydCk7CiAgICB3aGlsZSAoIXEuZW1wdHkoKSkgewogICAgICAgIGludCB1ID0gcS5mcm9udCgpOyBxLnBvcCgpOwogICAgICAgIGlmICh1ID09IGVuZCkgYnJlYWs7CiAgICAgICAgZm9yIChpbnQgdiA6IGFkalt1XSkgewogICAgICAgICAgICBpZiAoZGlzdFt2XSA9PSAtMSkgewogICAgICAgICAgICAgICAgZGlzdFt2XSA9IGRpc3RbdV0gKyAxOwogICAgICAgICAgICAgICAgcGFyZW50W3ZdID0gdTsKICAgICAgICAgICAgICAgIHEucHVzaCh2KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIHZlY3RvcjxpbnQ+IHBhdGg7CiAgICBpZiAoZGlzdFtlbmRdID09IC0xKSByZXR1cm4gcGF0aDsgLy8gbm8gcGF0aAogICAgZm9yIChpbnQgY3VyID0gZW5kOyBjdXIgIT0gLTE7IGN1ciA9IHBhcmVudFtjdXJdKSBwYXRoLnB1c2hfYmFjayhjdXIpOwogICAgcmV2ZXJzZShwYXRoLmJlZ2luKCksIHBhdGguZW5kKCkpOwogICAgcmV0dXJuIHBhdGg7Cn0KCmludCBtYWluKCkgewogICAgaW9zOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpOwogICAgY2luLnRpZShudWxscHRyKTsKICAgIGNpbiA+PiB0Y2FzZTsKICAgIHdoaWxlICh0Y2FzZS0tKSB7CiAgICAgICAgY2luID4+IG4gPj4gbTsKICAgICAgICBjaW4gPj4gc19pbml0ID4+IHNfdGFyZ2V0OwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbjsgaSsrKSBhZGpbaV0uY2xlYXIoKTsKCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBtOyBpKyspIHsKICAgICAgICAgICAgaW50IHUsIHY7IGNpbiA+PiB1ID4+IHY7CiAgICAgICAgICAgIHUtLSwgdi0tOwogICAgICAgICAgICBhZGpbdV0ucHVzaF9iYWNrKHYpOwogICAgICAgICAgICBhZGpbdl0ucHVzaF9iYWNrKHUpOwogICAgICAgIH0KCiAgICAgICAgLy8gRXh0cmFjdCBzdG9uZXMgaW5pdGlhbCBhbmQgdGFyZ2V0IHBvc2l0aW9ucwogICAgICAgIHN0b25lc19pbml0LmNsZWFyKCk7CiAgICAgICAgc3RvbmVzX3RhcmdldC5jbGVhcigpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgICAgIGlmIChzX2luaXRbaV0gPT0gJzEnKSBzdG9uZXNfaW5pdC5wdXNoX2JhY2soaSk7CiAgICAgICAgICAgIGlmIChzX3RhcmdldFtpXSA9PSAnMScpIHN0b25lc190YXJnZXQucHVzaF9iYWNrKGkpOwogICAgICAgIH0KCiAgICAgICAgY19zdG9uZXMgPSAoaW50KXN0b25lc19pbml0LnNpemUoKTsKCiAgICAgICAgLy8gUXVpY2sgY2hlY2s6IGlmIGNvdW50cyBkaWZmZXIgKHNob3VsZCBub3QgaGFwcGVuKSwgbm8KICAgICAgICBpZiAoc3RvbmVzX3RhcmdldC5zaXplKCkgIT0gY19zdG9uZXMpIHsKICAgICAgICAgICAgY291dCA8PCAiTm9cbiI7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgLy8gSWYgbm8gc3RvbmVzLCB0cml2aWFsCiAgICAgICAgaWYgKGNfc3RvbmVzID09IDApIHsKICAgICAgICAgICAgY291dCA8PCAiWWVzXG4wXG4iOwogICAgICAgICAgICAvLyBwcmludCBlbXB0eSBwb3NpdGlvbnMgbGluZXMKICAgICAgICAgICAgLy8gTm8gc3RvbmVzLCBzbyBubyBwb3NpdGlvbnMKICAgICAgICAgICAgY291dCA8PCAiXG4iOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIC8vIEJ1aWxkIGJpcGFydGl0ZSBncmFwaCBmb3IgbWF0Y2hpbmcgaW5pdGlhbCBzdG9uZXMgdG8gdGFyZ2V0IHN0b25lcyB0byBtaW5pbWl6ZSB0b3RhbCBkaXN0YW5jZQogICAgICAgIC8vIENvbXB1dGUgZGlzdGFuY2UgbWF0cml4CiAgICAgICAgdmVjdG9yPHZlY3RvcjxpbnQ+PiBkaXN0X21hdChjX3N0b25lcywgdmVjdG9yPGludD4oY19zdG9uZXMsIC0xKSk7CgogICAgICAgIC8vIEZvciBlYWNoIHN0b25lIGluaXRpYWwgcG9zaXRpb24sIEJGUyB0byBhbGwgdmVydGljZXMKICAgICAgICB2ZWN0b3I8dmVjdG9yPGludD4+IGRpc3RfZnJvbV9zdG9uZShjX3N0b25lcywgdmVjdG9yPGludD4obiwgLTEpKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNfc3RvbmVzOyBpKyspIHsKICAgICAgICAgICAgaW50IHN0YXJ0ID0gc3RvbmVzX2luaXRbaV07CiAgICAgICAgICAgIHZlY3RvcjxpbnQ+ICZkID0gZGlzdF9mcm9tX3N0b25lW2ldOwogICAgICAgICAgICBxdWV1ZTxpbnQ+IHE7CiAgICAgICAgICAgIGRbc3RhcnRdID0gMDsKICAgICAgICAgICAgcS5wdXNoKHN0YXJ0KTsKICAgICAgICAgICAgd2hpbGUgKCFxLmVtcHR5KCkpIHsKICAgICAgICAgICAgICAgIGludCB1ID0gcS5mcm9udCgpOyBxLnBvcCgpOwogICAgICAgICAgICAgICAgZm9yIChpbnQgdiA6IGFkalt1XSkgewogICAgICAgICAgICAgICAgICAgIGlmIChkW3ZdID09IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRbdl0gPSBkW3VdICsgMTsKICAgICAgICAgICAgICAgICAgICAgICAgcS5wdXNoKHYpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gRmlsbCBkaXN0X21hdAogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY19zdG9uZXM7IGkrKykgewogICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IGNfc3RvbmVzOyBqKyspIHsKICAgICAgICAgICAgICAgIGRpc3RfbWF0W2ldW2pdID0gZGlzdF9mcm9tX3N0b25lW2ldW3N0b25lc190YXJnZXRbal1dOwogICAgICAgICAgICAgICAgaWYgKGRpc3RfbWF0W2ldW2pdID09IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gTm8gcGF0aCBmcm9tIHN0b25lIGkgdG8gdGFyZ2V0IGoKICAgICAgICAgICAgICAgICAgICAvLyBUaGVuIG5vIHNvbHV0aW9uCiAgICAgICAgICAgICAgICAgICAgLy8gV2UgY2FuIGJyZWFrIGVhcmx5CiAgICAgICAgICAgICAgICAgICAgY291dCA8PCAiTm9cbiI7CiAgICAgICAgICAgICAgICAgICAgZ290byBuZXh0X2Nhc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIEh1bmdhcmlhbiBhbGdvcml0aG0gZm9yIG1pbmltdW0gd2VpZ2h0IHBlcmZlY3QgbWF0Y2hpbmcKICAgICAgICAvLyBXZSB1c2UgZGlzdF9tYXQgYXMgY29zdCBtYXRyaXgKCiAgICAgICAgLy8gSHVuZ2FyaWFuIGFsZ29yaXRobSBpbXBsZW1lbnRhdGlvbiBmb3IgbWluaW11bSBjb3N0IHBlcmZlY3QgbWF0Y2hpbmcKICAgICAgICBjb25zdCBpbnQgSU5GID0gMWU5OwogICAgICAgIGludCBOID0gY19zdG9uZXM7CiAgICAgICAgdmVjdG9yPGludD4gdShOKzEpLCB2KE4rMSksIHAoTisxKSwgd2F5KE4rMSk7CgogICAgICAgIGZvciAoaW50IGk9MTsgaTw9TjsgKytpKSB7CiAgICAgICAgICAgIHBbMF0gPSBpOwogICAgICAgICAgICBpbnQgajAgPSAwOwogICAgICAgICAgICB2ZWN0b3I8aW50PiBtaW52KE4rMSwgSU5GKTsKICAgICAgICAgICAgdmVjdG9yPGNoYXI+IHVzZWQoTisxLCBmYWxzZSk7CiAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgIHVzZWRbajBdID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGludCBpMCA9IHBbajBdLCBqMSA9IDAsIGRlbHRhID0gSU5GOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaj0xOyBqPD1OOyArK2opIHsKICAgICAgICAgICAgICAgICAgICBpZiAoIXVzZWRbal0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW50IGN1ciA9IGRpc3RfbWF0W2kwLTFdW2otMV0tdVtpMF0tdltqXTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1ciA8IG1pbnZbal0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbnZbal0gPSBjdXI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YXlbal0gPSBqMDsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZiAobWludltqXSA8IGRlbHRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWx0YSA9IG1pbnZbal07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqMSA9IGo7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBmb3IgKGludCBqPTA7IGo8PU47ICsraikgewogICAgICAgICAgICAgICAgICAgIGlmICh1c2VkW2pdKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHVbcFtqXV0gKz0gZGVsdGE7CiAgICAgICAgICAgICAgICAgICAgICAgIHZbal0gLT0gZGVsdGE7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgbWludltqXSAtPSBkZWx0YTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBqMCA9IGoxOwogICAgICAgICAgICB9IHdoaWxlIChwW2owXSAhPSAwKTsKICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgaW50IGoxID0gd2F5W2owXTsKICAgICAgICAgICAgICAgIHBbajBdID0gcFtqMV07CiAgICAgICAgICAgICAgICBqMCA9IGoxOwogICAgICAgICAgICB9IHdoaWxlIChqMCk7CiAgICAgICAgfQoKICAgICAgICB2ZWN0b3I8aW50PiBtYXRjaF90byhOLCAtMSk7CiAgICAgICAgZm9yIChpbnQgaj0xOyBqPD1OOyArK2opIHsKICAgICAgICAgICAgaWYgKHBbal0gPiAwKSB7CiAgICAgICAgICAgICAgICBtYXRjaF90b1twW2pdLTFdID0gai0xOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBCdWlsZCBwYXRocyBmb3IgZWFjaCBzdG9uZSBhY2NvcmRpbmcgdG8gbWF0Y2hpbmcKICAgICAgICBzdG9uZV9wYXRocy5jbGVhcigpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY19zdG9uZXM7IGkrKykgewogICAgICAgICAgICBpbnQgc3RhcnQgPSBzdG9uZXNfaW5pdFtpXTsKICAgICAgICAgICAgaW50IGVuZCA9IHN0b25lc190YXJnZXRbbWF0Y2hfdG9baV1dOwogICAgICAgICAgICB2ZWN0b3I8aW50PiBwYXRoID0gc2hvcnRlc3RfcGF0aChzdGFydCwgZW5kKTsKICAgICAgICAgICAgaWYgKHBhdGguZW1wdHkoKSkgewogICAgICAgICAgICAgICAgLy8gTm8gcGF0aCBmb3VuZCAoc2hvdWxkIG5vdCBoYXBwZW4pCiAgICAgICAgICAgICAgICBjb3V0IDw8ICJOb1xuIjsKICAgICAgICAgICAgICAgIGdvdG8gbmV4dF9jYXNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHN0b25lX3BhdGhzLnB1c2hfYmFjayhwYXRoKTsKICAgICAgICB9CgogICAgICAgIC8vIE5vdyB3ZSBzaW11bGF0ZSBtb3ZlcwogICAgICAgIC8vIHBhdGhfcG9zW2ldID0gY3VycmVudCBpbmRleCBpbiBzdG9uZV9wYXRoc1tpXQogICAgICAgIHBhdGhfcG9zLmFzc2lnbihjX3N0b25lcywgMCk7CgogICAgICAgIC8vIEN1cnJlbnQgcG9zaXRpb25zIG9mIHN0b25lcwogICAgICAgIHZlY3RvcjxpbnQ+IGN1cnJfcG9zKGNfc3RvbmVzKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNfc3RvbmVzOyBpKyspIHsKICAgICAgICAgICAgY3Vycl9wb3NbaV0gPSBzdG9uZV9wYXRoc1tpXVswXTsKICAgICAgICB9CgogICAgICAgIC8vIEZvciBvdXRwdXQsIHdlIHN0b3JlIHRoZSBzZXF1ZW5jZSBvZiBzdGF0ZXMgKHBvc2l0aW9ucyBvZiBzdG9uZXMgaW4gb3JkZXIgMC4uYy0xKQogICAgICAgIHZlY3Rvcjx2ZWN0b3I8aW50Pj4gbW92ZXNfc3RhdGVzOwogICAgICAgIG1vdmVzX3N0YXRlcy5wdXNoX2JhY2soY3Vycl9wb3MpOwoKICAgICAgICAvLyBXZSBkbyBhdCBtb3N0IDIqbiBtb3ZlcwogICAgICAgIGludCBtYXhfbW92ZXMgPSAyKm47CgogICAgICAgIC8vIFRvIGF2b2lkIGNvbGxpc2lvbnMsIHdlIG1vdmUgc3RvbmVzIGluIG9yZGVyIG9mIHRoZWlyIHJlbWFpbmluZyBwYXRoIGxlbmd0aCBkZXNjZW5kaW5nCiAgICAgICAgLy8gV2UgbW92ZSBzdG9uZXMgdGhhdCBjYW4gYWR2YW5jZSBmb3J3YXJkIHNpbXVsdGFuZW91c2x5IGlmIHRoZWlyIG5leHQgcG9zaXRpb25zIGRvIG5vdCBjb2xsaWRlCgogICAgICAgIC8vIFdlJ2xsIHRyeSBhIGdyZWVkeSBhcHByb2FjaDoKICAgICAgICAvLyBJbiBlYWNoIG1vdmU6CiAgICAgICAgLy8gLSBGb3Igc3RvbmVzIHRoYXQgYXJlIG5vdCBhdCB0YXJnZXQgKHBhdGhfcG9zW2ldIDwgcGF0aC5zaXplKCktMSksCiAgICAgICAgLy8gICB3ZSBjaGVjayBpZiB0aGVpciBuZXh0IHZlcnRleCBpcyBmcmVlCiAgICAgICAgLy8gLSBXZSBtb3ZlIHNpbXVsdGFuZW91c2x5IGFsbCBzdG9uZXMgdGhhdCBjYW4gYWR2YW5jZSB3aXRob3V0IGNvbGxpc2lvbgoKICAgICAgICBib29sIHByb2dyZXNzID0gdHJ1ZTsKICAgICAgICBpbnQgbW92ZXNfZG9uZSA9IDA7CgogICAgICAgIHdoaWxlIChtb3Zlc19kb25lIDwgbWF4X21vdmVzICYmIHByb2dyZXNzKSB7CiAgICAgICAgICAgIHByb2dyZXNzID0gZmFsc2U7CgogICAgICAgICAgICAvLyBNYXJrIG9jY3VwaWVkIHZlcnRpY2VzCiAgICAgICAgICAgIHZlY3RvcjxpbnQ+IG9jY3VwaWVkKG4sIC0xKTsgLy8gd2hpY2ggc3RvbmUgb2NjdXBpZXMgdmVydGV4CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY19zdG9uZXM7IGkrKykgewogICAgICAgICAgICAgICAgb2NjdXBpZWRbY3Vycl9wb3NbaV1dID0gaTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gU3RvbmVzIHRoYXQgd2FudCB0byBtb3ZlIGFuZCB0aGVpciBuZXh0IHZlcnRleAogICAgICAgICAgICB2ZWN0b3I8aW50PiBzdG9uZXNfdG9fbW92ZTsKICAgICAgICAgICAgdmVjdG9yPGludD4gbmV4dF92ZXJ0aWNlcyhjX3N0b25lcywgLTEpOwoKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjX3N0b25lczsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAocGF0aF9wb3NbaV0gPCAoaW50KXN0b25lX3BhdGhzW2ldLnNpemUoKSAtIDEpIHsKICAgICAgICAgICAgICAgICAgICBpbnQgbnh0ID0gc3RvbmVfcGF0aHNbaV1bcGF0aF9wb3NbaV0rMV07CiAgICAgICAgICAgICAgICAgICAgbmV4dF92ZXJ0aWNlc1tpXSA9IG54dDsKICAgICAgICAgICAgICAgICAgICBzdG9uZXNfdG9fbW92ZS5wdXNoX2JhY2soaSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFRvIGF2b2lkIGNvbGxpc2lvbnMsIHdlIHBpY2sgc3RvbmVzIHRoYXQgZG8gbm90IGNvbmZsaWN0CiAgICAgICAgICAgIC8vIFdlIHVzZSBhIGdyZWVkeSBhcHByb2FjaDoKICAgICAgICAgICAgLy8gU29ydCBzdG9uZXMgYnkgcmVtYWluaW5nIHBhdGggbGVuZ3RoIGRlc2NlbmRpbmcKCiAgICAgICAgICAgIHNvcnQoc3RvbmVzX3RvX21vdmUuYmVnaW4oKSwgc3RvbmVzX3RvX21vdmUuZW5kKCksIFsmXShpbnQgYSwgaW50IGIpIHsKICAgICAgICAgICAgICAgIHJldHVybiAoKGludClzdG9uZV9wYXRoc1thXS5zaXplKCkgLSBwYXRoX3Bvc1thXSkgPiAoKGludClzdG9uZV9wYXRoc1tiXS5zaXplKCkgLSBwYXRoX3Bvc1tiXSk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgdmVjdG9yPGJvb2w+IGNhbl9tb3ZlKGNfc3RvbmVzLCBmYWxzZSk7CiAgICAgICAgICAgIHZlY3Rvcjxib29sPiB2ZXJ0ZXhfdGFrZW4obiwgZmFsc2UpOwoKICAgICAgICAgICAgLy8gTWFyayBjdXJyZW50bHkgb2NjdXBpZWQgdmVydGljZXMgYXMgdGFrZW4KICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjX3N0b25lczsgaSsrKSB7CiAgICAgICAgICAgICAgICB2ZXJ0ZXhfdGFrZW5bY3Vycl9wb3NbaV1dID0gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gV2Ugd2lsbCBmcmVlIGN1cnJlbnQgcG9zaXRpb25zIG9mIHN0b25lcyBtb3ZpbmcsIHNvIHdlIGhhbmRsZSBjYXJlZnVsbHkKICAgICAgICAgICAgLy8gV2UgZmlyc3QgbWFyayBuZXh0IHZlcnRpY2VzIHRvIGNoZWNrIGZvciBjb2xsaXNpb25zCgogICAgICAgICAgICAvLyBXZSB0cnkgdG8gbW92ZSBzdG9uZXMgb25lIGJ5IG9uZSBpbiBvcmRlcgogICAgICAgICAgICBmb3IgKGludCBpIDogc3RvbmVzX3RvX21vdmUpIHsKICAgICAgICAgICAgICAgIGludCBueHQgPSBuZXh0X3ZlcnRpY2VzW2ldOwogICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgbmV4dCB2ZXJ0ZXggaXMgZnJlZSBvciBpcyBjdXJyZW50IHBvc2l0aW9uIG9mIHN0b25lIGkKICAgICAgICAgICAgICAgIC8vIEJlY2F1c2Ugc3RvbmVzIG1vdmUgc2ltdWx0YW5lb3VzbHksIHRoZSBjdXJyZW50IHBvc2l0aW9ucyBvZiBzdG9uZXMgbW92aW5nIGF3YXkgd2lsbCBiZSBmcmVlCgogICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgbnh0IGlzIG5vdCB0YWtlbiBieSBhIHN0b25lIHRoYXQgaXMgbm90IG1vdmluZyB0aGlzIHR1cm4KICAgICAgICAgICAgICAgIGJvb2wgb2NjdXBpZWRfYnlfZml4ZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGlmICh2ZXJ0ZXhfdGFrZW5bbnh0XSkgewogICAgICAgICAgICAgICAgICAgIGludCBvY2Nfc3RvbmUgPSBvY2N1cGllZFtueHRdOwogICAgICAgICAgICAgICAgICAgIGlmIChvY2Nfc3RvbmUgPT0gLTEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgb2NjdXBpZWRfYnlfZml4ZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBvY2Nfc3RvbmUgaXMgbW92aW5nIHRoaXMgdHVybiwgcG9zaXRpb24gbnh0IHdpbGwgYmUgZnJlZQogICAgICAgICAgICAgICAgICAgICAgICAvLyBCdXQgc3RvbmVzIG1vdmUgc2ltdWx0YW5lb3VzbHksIHNvIGEgc3RvbmUgbW92aW5nIG91dCBmcmVlcyB0aGF0IHZlcnRleAogICAgICAgICAgICAgICAgICAgICAgICAvLyBTbyBpZiBvY2Nfc3RvbmUgaXMgbW92aW5nLCB3ZSBjYW4gbW92ZSBoZXJlCiAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgb2NjX3N0b25lX21vdmluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAocGF0aF9wb3Nbb2NjX3N0b25lXSA8IChpbnQpc3RvbmVfcGF0aHNbb2NjX3N0b25lXS5zaXplKCkgLSAxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvY2Nfc3RvbmVfbW92aW5nID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW9jY19zdG9uZV9tb3ZpbmcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9jY3VwaWVkX2J5X2ZpeGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoIW9jY3VwaWVkX2J5X2ZpeGVkKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gTWFyayBueHQgYXMgdGFrZW4gZm9yIHRoaXMgbW92ZQogICAgICAgICAgICAgICAgICAgIHZlcnRleF90YWtlbltueHRdID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBjYW5fbW92ZVtpXSA9IHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChjb3VudChjYW5fbW92ZS5iZWdpbigpLCBjYW5fbW92ZS5lbmQoKSwgdHJ1ZSkgPT0gMCkgewogICAgICAgICAgICAgICAgLy8gTm8gc3RvbmVzIGNhbiBtb3ZlLCBicmVhawogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIE1vdmUgc3RvbmVzCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY19zdG9uZXM7IGkrKykgewogICAgICAgICAgICAgICAgaWYgKGNhbl9tb3ZlW2ldKSB7CiAgICAgICAgICAgICAgICAgICAgcGF0aF9wb3NbaV0rKzsKICAgICAgICAgICAgICAgICAgICBjdXJyX3Bvc1tpXSA9IHN0b25lX3BhdGhzW2ldW3BhdGhfcG9zW2ldXTsKICAgICAgICAgICAgICAgICAgICBwcm9ncmVzcyA9IHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG1vdmVzX3N0YXRlcy5wdXNoX2JhY2soY3Vycl9wb3MpOwogICAgICAgICAgICBtb3Zlc19kb25lKys7CiAgICAgICAgfQoKICAgICAgICAvLyBDaGVjayBpZiBmaW5hbCBwb3NpdGlvbnMgbWF0Y2ggdGFyZ2V0CiAgICAgICAgYm9vbCBzdWNjZXNzID0gdHJ1ZTsKICAgICAgICB2ZWN0b3I8aW50PiBmaW5hbF9wb3MgPSBtb3Zlc19zdGF0ZXMuYmFjaygpOwogICAgICAgIHZlY3Rvcjxib29sPiB1c2VkX3RhcmdldChuLCBmYWxzZSk7CiAgICAgICAgZm9yIChpbnQgdiA6IHN0b25lc190YXJnZXQpIHVzZWRfdGFyZ2V0W3ZdID0gdHJ1ZTsKCiAgICAgICAgZm9yIChpbnQgcG9zIDogZmluYWxfcG9zKSB7CiAgICAgICAgICAgIGlmICghdXNlZF90YXJnZXRbcG9zXSkgewogICAgICAgICAgICAgICAgc3VjY2VzcyA9IGZhbHNlOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdXNlZF90YXJnZXRbcG9zXSA9IGZhbHNlOyAvLyBlYWNoIHN0b25lIG11c3QgbWF0Y2ggdW5pcXVlIHRhcmdldAogICAgICAgIH0KCiAgICAgICAgaWYgKCFzdWNjZXNzKSB7CiAgICAgICAgICAgIGNvdXQgPDwgIk5vXG4iOwogICAgICAgICAgICBnb3RvIG5leHRfY2FzZTsKICAgICAgICB9CgogICAgICAgIGNvdXQgPDwgIlllc1xuIiA8PCAoaW50KShtb3Zlc19zdGF0ZXMuc2l6ZSgpLTEpIDw8ICJcbiI7CiAgICAgICAgLy8gT3V0cHV0IHN0b25lcyBwb3NpdGlvbnMgcGVyIGxpbmUsIHN0b25lcyBpbmRleGVkIDAuLmMtMSwgcG9zaXRpb25zICsxIGZvciAxLWJhc2VkCiAgICAgICAgZm9yIChhdXRvICZzdGF0ZSA6IG1vdmVzX3N0YXRlcykgewogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNfc3RvbmVzOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvdXQgPDwgc3RhdGVbaV0rMSA8PCAoaT09Y19zdG9uZXMtMSA/ICdcbicgOiAnICcpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBuZXh0X2Nhc2U6IDsKICAgIH0KICAgIHJldHVybiAwOwp9Cg==' | base64 -d > /app/main.cpp", 'Enter']
['asciinema rec --stdin /logs/tests.cast', 'Enter']
['clear', 'Enter']
['bash ', '/tests/run-tests.sh', 'Enter']
['C-d']
['C-d']
